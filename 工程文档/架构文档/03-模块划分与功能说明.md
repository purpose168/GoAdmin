# GoAdmin 模块划分与功能说明

## 文档信息

- **项目名称**: GoAdmin
- **文档版本**: v1.0
- **创建日期**: 2026-01-05
- **最后更新**: 2026-01-05
- **文档类型**: 模块说明

---

## 1. 模块架构概览

GoAdmin 采用模块化设计，将系统功能划分为多个独立的模块。每个模块负责特定的功能领域，模块之间通过接口进行通信，实现高内聚、低耦合。

### 1.1 模块分层

```
┌─────────────────────────────────────────────────────────┐
│                    应用层 (Application)                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │   Plugins   │  │   Adapter   │  │   Template   │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                    引擎层 (Engine)                       │
│  ┌──────────────────────────────────────────────────┐  │
│  │              Core Engine                         │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                    模块层 (Modules)                       │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐     │
│  │Auth │ │ DB  │ │Menu │ │ UI  │ │File │ │Log  │     │
│  └─────┘ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘     │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐     │
│  │Conf │ │Lang │ │Sys  │ │Trace│ │Err  │ │Page │     │
│  └─────┘ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘     │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐                        │
│  │Serv │ │Util │ │Coll │ │Remo │                        │
│  └─────┘ └─────┘ └─────┘ └─────┘                        │
└─────────────────────────────────────────────────────────┘
```

### 1.2 模块分类

| 分类 | 模块 | 功能描述 |
|-----|------|---------|
| **核心模块** | Engine | 核心引擎，协调所有组件 |
| **认证授权** | Auth | 用户认证和权限管理 |
| **数据访问** | DB | 数据库操作和连接管理 |
| **界面展示** | UI | UI 组件和页面渲染 |
| **配置管理** | Config | 配置加载和管理 |
| **菜单管理** | Menu | 菜单生成和权限控制 |
| **文件处理** | File | 文件上传和管理 |
| **日志记录** | Logger | 日志记录和管理 |
| **国际化** | Language | 多语言支持 |
| **系统信息** | System | 系统信息和监控 |
| **链路追踪** | Trace | 请求追踪和性能监控 |
| **错误处理** | Errors | 错误定义和处理 |
| **页面管理** | Page | 页面管理和路由 |
| **服务接口** | Service | 服务注册和获取 |
| **工具函数** | Utils | 通用工具函数 |
| **数据集合** | Collection | 数据集合操作 |
| **远程服务** | Remote Server | 远程服务调用 |

---

## 2. 核心模块详解

### 2.1 Engine (核心引擎)

**目录**: [engine/](file:///home/pps/code/GoAdmin/GoAdmin/engine)

**核心文件**: [engine.go](file:///home/pps/code/GoAdmin/GoAdmin/engine/engine.go)

**功能描述**:
Engine 是 GoAdmin 的核心组件，负责协调插件、适配器和各种服务。它提供了配置管理、数据库连接、路由注册、页面渲染等核心功能。

**主要职责**:
- 插件生命周期管理
- 适配器集成
- 服务注册与获取
- 路由注册与管理
- 配置管理
- 数据库连接管理

**核心结构**:

```go
type Engine struct {
    PluginList   []Plugin
    Adapter      Adapter
    Services     service.List
    NavButtons   []types.NavButton
    config       *config.Config
    announceLock sync.Mutex
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Default()` | 创建默认引擎实例 |
| `AddConfig(cfg)` | 添加配置 |
| `AddPlugins(plugins)` | 添加插件 |
| `Use(adapter)` | 启用适配器 |
| `HTML(ctx, user, panel)` | 渲染 HTML 页面 |
| `Data(ctx, user, panel)` | 返回 JSON 数据 |
| `HTMLFile(ctx, user, panel)` | 渲染 HTML 文件 |

**使用示例**:

```go
eng := engine.Default()

eng.AddConfig(&config.Config{
    Databases: config.DatabaseList{
        Default: "default",
        ...
    },
})

eng.AddPlugins(admin.NewAdmin())

eng.Use(router)
```

---

### 2.2 Auth (认证授权)

**目录**: [modules/auth/](file:///home/pps/code/GoAdmin/GoAdmin/modules/auth)

**核心文件**: [auth.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/auth/auth.go), [middleware.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/auth/middleware.go), [session.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/auth/session.go)

**功能描述**:
Auth 模块提供用户认证和权限管理功能，包括 Session 管理、Token 认证、权限验证等。

**主要功能**:

1. **用户认证**:
   - 用户登录验证
   - 密码加密存储
   - 验证码校验
   - 会话管理

2. **权限管理**:
   - RBAC 权限控制
   - 菜单权限验证
   - 操作权限验证
   - 角色管理

3. **中间件**:
   - 认证中间件
   - 权限中间件
   - 登录检查
   - 会话验证

**核心结构**:

```go
type Auth struct {
    Conn         db.Connection
    Config       *config.Config
    SessionStore SessionStore
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Login(username, password)` | 用户登录 |
| `Logout(ctx)` | 用户登出 |
| `CheckLogin(ctx)` | 检查登录状态 |
| `GetUser(ctx)` | 获取当前用户 |
| `HasPermission(user, permission)` | 检查权限 |
| `AuthMiddleware()` | 认证中间件 |
| `PermissionMiddleware()` | 权限中间件 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/auth"

// 用户登录
user, err := auth.Login("admin", "password")

// 检查权限
if auth.HasPermission(user, "user.create") {
    // 允许创建用户
}

// 使用中间件
r.Use(auth.AuthMiddleware())
```

---

### 2.3 DB (数据库)

**目录**: [modules/db/](file:///home/pps/code/GoAdmin/GoAdmin/modules/db)

**核心文件**: [db.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/db/db.go), [mysql.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/db/mysql.go), [postgresql.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/db/postgresql.go)

**功能描述**:
DB 模块提供数据库连接管理和 SQL 操作功能，支持多种数据库。

**支持的数据库**:
- MySQL
- PostgreSQL
- SQLite
- SQL Server
- OceanBase

**主要功能**:

1. **连接管理**:
   - 连接池管理
   - 连接复用
   - 连接超时
   - 连接健康检查

2. **SQL 操作**:
   - 查询构建
   - 参数化查询
   - 事务管理
   - 批量操作

3. **方言支持**:
   - 数据库方言适配
   - SQL 语法转换
   - 数据类型映射

**核心结构**:

```go
type Connection interface {
    Query(query string, args ...interface{}) (*sql.Rows, error)
    Exec(query string, args ...interface{}) (sql.Result, error)
    Begin() (*sql.Tx, error)
    Close() error
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `GetConnection(name)` | 获取数据库连接 |
| `Query(query, args)` | 执行查询 |
| `Exec(query, args)` | 执行 SQL |
| `Begin()` | 开始事务 |
| `Commit()` | 提交事务 |
| `Rollback()` | 回滚事务 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/db"

// 获取连接
conn := db.GetConnection("default")

// 执行查询
rows, err := conn.Query("SELECT * FROM users WHERE id = ?", 1)

// 执行事务
tx, err := conn.Begin()
tx.Exec("INSERT INTO users (name) VALUES (?)", "admin")
tx.Commit()
```

---

### 2.4 Menu (菜单管理)

**目录**: [modules/menu/](file:///home/pps/code/GoAdmin/GoAdmin/modules/menu)

**核心文件**: [menu.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/menu/menu.go)

**功能描述**:
Menu 模块提供菜单生成和管理功能，支持多级菜单、权限控制、图标显示等。

**主要功能**:

1. **菜单生成**:
   - 多级菜单
   - 动态菜单
   - 菜单排序
   - 菜单图标

2. **权限控制**:
   - 基于角色的菜单
   - 菜单权限验证
   - 菜单显示控制

3. **菜单渲染**:
   - HTML 渲染
   - JSON 输出
   - 自定义模板

**核心结构**:

```go
type Item struct {
    Name         string
    ID           string
    Url          string
    Icon         string
    Header       string
    Active       string
    ChildrenList []Item
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `GetMenu(user)` | 获取用户菜单 |
| `GenerateMenu(items)` | 生成菜单 HTML |
| `AddMenuItem(item)` | 添加菜单项 |
| `UpdateMenuItem(item)` | 更新菜单项 |
| `DeleteMenuItem(id)` | 删除菜单项 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/menu"

// 获取用户菜单
menuItems := menu.GetMenu(user)

// 生成菜单 HTML
menuHTML := menu.GenerateMenu(menuItems)

// 添加菜单项
menu.AddMenuItem(menu.Item{
    Name: "用户管理",
    Url:  "/admin/users",
    Icon: "fa-users",
})
```

---

### 2.5 UI (界面组件)

**目录**: [modules/ui/](file:///home/pps/code/GoAdmin/GoAdmin/modules/ui)

**核心文件**: [ui.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/ui/ui.go)

**功能描述**:
UI 模块提供 UI 组件和页面渲染功能，包括面板组件、导航组件、表单组件等。

**主要功能**:

1. **面板组件**:
   - 面板渲染
   - 内容展示
   - 标题设置
   - 描述设置

2. **导航组件**:
   - 导航栏
   - 面包屑
   - 标签页
   - 按钮组

3. **表单组件**:
   - 表单渲染
   - 表单验证
   - 表单提交
   - 错误提示

**核心结构**:

```go
type UI struct {
    NavButtons []types.NavButton
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `RenderPanel(panel)` | 渲染面板 |
| `RenderNav()` | 渲染导航 |
| `RenderForm(form)` | 渲染表单 |
| `AddNavButton(btn)` | 添加导航按钮 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/ui"

// 渲染面板
panelHTML := ui.RenderPanel(types.Panel{
    Title:       "用户列表",
    Description: "管理系统用户",
    Content:     userTableHTML,
})

// 添加导航按钮
ui.AddNavButton(types.NavButton{
    Title: "设置",
    Icon:  "fa-cog",
    Url:   "/admin/settings",
})
```

---

### 2.6 Config (配置管理)

**目录**: [modules/config/](file:///home/pps/code/GoAdmin/GoAdmin/modules/config)

**核心文件**: [config.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/config/config.go)

**功能描述**:
Config 模块提供配置加载和管理功能，支持多种配置格式。

**支持的格式**:
- INI
- YAML
- JSON

**主要功能**:

1. **配置加载**:
   - 文件加载
   - 环境变量
   - 命令行参数
   - 默认值

2. **配置管理**:
   - 配置验证
   - 配置热更新
   - 配置缓存
   - 配置导出

3. **配置类型**:
   - 服务器配置
   - 数据库配置
   - 日志配置
   - 文件上传配置

**核心结构**:

```go
type Config struct {
    UrlPrefix          string
    IndexUrl           string
    LoginUrl           string
    AssetUrl           string
    Domain             string
    Env                string
    Language           string
    Theme              string
    Title              string
    Logo               template.HTML
    MiniSidebar        bool
    ColorScheme        string
    SessionLifeTime    int
    Databases          DatabaseList
    Logger             Logger
    FileUploadEngine   FileUploadEngine
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `LoadFromFile(path)` | 从文件加载配置 |
| `LoadFromEnv()` | 从环境变量加载 |
| `Validate()` | 验证配置 |
| `Get(key)` | 获取配置项 |
| `Set(key, value)` | 设置配置项 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/config"

// 加载配置
cfg, err := config.LoadFromFile("config.json")

// 获取配置项
title := cfg.Title

// 验证配置
if err := cfg.Validate(); err != nil {
    panic(err)
}
```

---

### 2.7 File (文件处理)

**目录**: [modules/file/](file:///home/pps/code/GoAdmin/GoAdmin/modules/file)

**核心文件**: [file.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/file/file.go)

**功能描述**:
File 模块提供文件上传和管理功能，支持多种存储引擎。

**支持的存储引擎**:
- 本地存储
- 阿里云 OSS
- AWS S3

**主要功能**:

1. **文件上传**:
   - 单文件上传
   - 多文件上传
   - 文件验证
   - 文件重命名

2. **文件管理**:
   - 文件删除
   - 文件移动
   - 文件复制
   - 文件信息

3. **存储引擎**:
   - 本地存储
   - 云存储
   - 自定义存储

**核心结构**:

```go
type File struct {
    Name     string
    Path     string
    Size     int64
    MimeType string
    URL      string
}
```

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Upload(file)` | 上传文件 |
| `Delete(path)` | 删除文件 |
| `GetInfo(path)` | 获取文件信息 |
| `Move(src, dst)` | 移动文件 |
| `Copy(src, dst)` | 复制文件 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/file"

// 上传文件
uploadedFile, err := file.Upload(uploadedFile)

// 删除文件
err := file.Delete("/uploads/image.jpg")

// 获取文件信息
info, err := file.GetInfo("/uploads/image.jpg")
```

---

### 2.8 Logger (日志记录)

**目录**: [modules/logger/](file:///home/pps/code/GoAdmin/GoAdmin/modules/logger)

**功能描述**:
Logger 模块提供日志记录和管理功能，支持多级别日志和日志轮转。

**主要功能**:

1. **日志级别**:
   - Debug
   - Info
   - Warn
   - Error
   - Fatal

2. **日志输出**:
   - 文件输出
   - 控制台输出
   - 远程输出
   - 自定义输出

3. **日志管理**:
   - 日志轮转
   - 日志压缩
   - 日志归档
   - 日志清理

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Debug(msg, fields)` | 记录 Debug 日志 |
| `Info(msg, fields)` | 记录 Info 日志 |
| `Warn(msg, fields)` | 记录 Warn 日志 |
| `Error(msg, fields)` | 记录 Error 日志 |
| `Fatal(msg, fields)` | 记录 Fatal 日志 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/logger"

// 记录日志
logger.Info("User login", logger.Fields{
    "username": "admin",
    "ip":       "127.0.0.1",
})

logger.Error("Database connection failed", logger.Fields{
    "error": err.Error(),
})
```

---

### 2.9 Language (国际化)

**目录**: [modules/language/](file:///home/pps/code/GoAdmin/GoAdmin/modules/language)

**核心文件**: [cn.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/language/cn.go), [en.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/language/en.go), [jp.go](file:///home/pps/code/GoAdmin/GoAdmin/modules/language/jp.go)

**功能描述**:
Language 模块提供多语言支持功能，支持中文、英文、日文、繁体中文、俄文等。

**支持的语言**:
- 中文简体 (cn)
- 英文 (en)
- 日文 (jp)
- 中文繁体 (tc)
- 俄文 (ru)

**主要功能**:

1. **语言管理**:
   - 语言切换
   - 语言加载
   - 语言缓存
   - 语言验证

2. **翻译功能**:
   - 文本翻译
   - 参数替换
   - 复数形式
   - 上下文翻译

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Get(key)` | 获取翻译 |
| `SetLanguage(lang)` | 设置语言 |
| `GetLanguage()` | 获取当前语言 |
| `AddLanguage(lang, data)` | 添加语言 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/language"

// 获取翻译
text := language.Get("login")
// 返回: "登录" (中文) / "Login" (英文)

// 切换语言
language.SetLanguage("en")

// 带参数的翻译
text := language.GetWithParams("welcome %s", "admin")
```

---

### 2.10 System (系统信息)

**目录**: [modules/system/](file:///home/pps/code/GoAdmin/GoAdmin/modules/system)

**功能描述**:
System 模块提供系统信息和监控功能。

**主要功能**:

1. **系统信息**:
   - 操作系统信息
   - CPU 信息
   - 内存信息
   - 磁盘信息

2. **应用信息**:
   - 应用版本
   - 运行时间
   - 协程数量
   - GC 信息

3. **性能监控**:
   - 请求统计
   - 响应时间
   - 错误率
   - 吞吐量

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `GetOSInfo()` | 获取操作系统信息 |
| `GetCPUInfo()` | 获取 CPU 信息 |
| `GetMemInfo()` | 获取内存信息 |
| `GetDiskInfo()` | 获取磁盘信息 |
| `GetAppInfo()` | 获取应用信息 |
| `GetGoroutineCount()` | 获取协程数量 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/system"

// 获取系统信息
osInfo := system.GetOSInfo()
cpuInfo := system.GetCPUInfo()
memInfo := system.GetMemInfo()

// 获取应用信息
appInfo := system.GetAppInfo()
fmt.Printf("Version: %s\n", appInfo.Version)
```

---

### 2.11 Trace (链路追踪)

**目录**: [modules/trace/](file:///home/pps/code/GoAdmin/GoAdmin/modules/trace)

**功能描述**:
Trace 模块提供请求追踪和性能监控功能。

**主要功能**:

1. **请求追踪**:
   - 请求 ID 生成
   - 请求链路追踪
   - 请求日志记录
   - 请求性能分析

2. **性能监控**:
   - 响应时间统计
   - 慢查询识别
   - 错误追踪
   - 性能瓶颈分析

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `StartTrace()` | 开始追踪 |
| `EndTrace()` | 结束追踪 |
| `GetTraceID()` | 获取追踪 ID |
| `RecordMetric()` | 记录指标 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/trace"

// 开始追踪
traceID := trace.StartTrace()
defer trace.EndTrace()

// 记录指标
trace.RecordMetric("request_time", 100)
```

---

### 2.12 Errors (错误处理)

**目录**: [modules/errors/](file:///home/pps/code/GoAdmin/GoAdmin/modules/errors)

**功能描述**:
Errors 模块提供错误定义和处理功能。

**主要功能**:

1. **错误定义**:
   - 错误类型
   - 错误码
   - 错误信息
   - 错误堆栈

2. **错误处理**:
   - 错误捕获
   - 错误包装
   - 错误传播
   - 错误日志

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `New(msg)` | 创建新错误 |
| `Wrap(err, msg)` | 包装错误 |
| `GetCode(err)` | 获取错误码 |
| `GetMessage(err)` | 获取错误信息 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/errors"

// 创建错误
err := errors.New("user not found")

// 包装错误
err = errors.Wrap(err, "failed to get user")

// 获取错误信息
msg := errors.GetMessage(err)
```

---

### 2.13 Page (页面管理)

**目录**: [modules/page/](file:///home/pps/code/GoAdmin/GoAdmin/modules/page)

**功能描述**:
Page 模块提供页面管理和路由功能。

**主要功能**:

1. **页面管理**:
   - 页面注册
   - 页面路由
   - 页面权限
   - 页面缓存

2. **路由管理**:
   - 路由注册
   - 路由分组
   - 路由参数
   - 路由中间件

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `RegisterPage(page)` | 注册页面 |
| `GetPage(path)` | 获取页面 |
| `RegisterRoute(route)` | 注册路由 |
| `GetRoute(path)` | 获取路由 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/page"

// 注册页面
page.RegisterPage(page.Page{
    Path:    "/admin/users",
    Title:   "用户管理",
    Handler: userHandler,
})
```

---

### 2.14 Service (服务接口)

**目录**: [modules/service/](file:///home/pps/code/GoAdmin/GoAdmin/modules/service)

**功能描述**:
Service 模块提供服务注册和获取功能。

**主要功能**:

1. **服务注册**:
   - 服务注册
   - 服务依赖
   - 服务生命周期
   - 服务单例

2. **服务获取**:
   - 按名称获取
   - 按类型获取
   - 服务验证
   - 服务缓存

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Register(name, service)` | 注册服务 |
| `Get(name)` | 获取服务 |
| `GetByType(typ)` | 按类型获取 |
| `Has(name)` | 检查服务是否存在 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/service"

// 注册服务
service.Register("config", cfg)

// 获取服务
cfg := service.Get("config").(*config.Config)
```

---

### 2.15 Utils (工具函数)

**目录**: [modules/utils/](file:///home/pps/code/GoAdmin/GoAdmin/modules/utils)

**功能描述**:
Utils 模块提供通用工具函数。

**主要功能**:

1. **字符串处理**:
   - 字符串截取
   - 字符串替换
   - 字符串分割
   - 字符串连接

2. **时间处理**:
   - 时间格式化
   - 时间解析
   - 时间计算
   - 时区转换

3. **数据转换**:
   - 类型转换
   - JSON 序列化
   - XML 序列化
   - 数据验证

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Substr(s, start, end)` | 字符串截取 |
| `FormatTime(t, format)` | 时间格式化 |
| `ToInt(v)` | 转换为整数 |
| `ToJSON(v)` | 转换为 JSON |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/utils"

// 字符串截取
substr := utils.Substr("hello world", 0, 5)

// 时间格式化
formatted := utils.FormatTime(time.Now(), "2006-01-02 15:04:05")

// 类型转换
num := utils.ToInt("123")
```

---

### 2.16 Collection (数据集合)

**目录**: [modules/collection/](file:///home/pps/code/GoAdmin/GoAdmin/modules/collection)

**功能描述**:
Collection 模块提供数据集合操作功能。

**主要功能**:

1. **集合操作**:
   - 过滤
   - 映射
   - 排序
   - 分组

2. **数据聚合**:
   - 求和
   - 平均值
   - 最大值
   - 最小值

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Filter(fn)` | 过滤集合 |
| `Map(fn)` | 映射集合 |
| `Sort(fn)` | 排序集合 |
| `Group(fn)` | 分组集合 |
| `Sum()` | 求和 |
| `Avg()` | 平均值 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/collection"

// 创建集合
col := collection.New([]int{1, 2, 3, 4, 5})

// 过滤
filtered := col.Filter(func(v int) bool {
    return v > 2
})

// 映射
mapped := col.Map(func(v int) interface{} {
    return v * 2
})
```

---

### 2.17 Remote Server (远程服务)

**目录**: [modules/remote_server/](file:///home/pps/code/GoAdmin/GoAdmin/modules/remote_server)

**功能描述**:
Remote Server 模块提供远程服务调用功能。

**主要功能**:

1. **HTTP 请求**:
   - GET 请求
   - POST 请求
   - PUT 请求
   - DELETE 请求

2. **服务调用**:
   - 同步调用
   - 异步调用
   - 重试机制
   - 超时控制

**主要方法**:

| 方法 | 功能描述 |
|-----|---------|
| `Get(url, params)` | 发送 GET 请求 |
| `Post(url, data)` | 发送 POST 请求 |
| `Put(url, data)` | 发送 PUT 请求 |
| `Delete(url)` | 发送 DELETE 请求 |

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/modules/remote_server"

// 发送 GET 请求
resp, err := remote_server.Get("https://api.example.com/users", map[string]string{
    "page": "1",
})

// 发送 POST 请求
resp, err := remote_server.Post("https://api.example.com/users", map[string]interface{}{
    "name": "admin",
})
```

---

## 3. 插件系统

### 3.1 Admin Plugin

**目录**: [plugins/admin/](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin)

**核心文件**: [admin.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/admin.go), [router.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/router.go)

**功能描述**:
Admin Plugin 是 GoAdmin 的核心插件，提供完整的后台管理功能。

**主要组件**:

1. **Controller (控制器)**:
   - [auth.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/auth.go): 认证控制器
   - [common.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/common.go): 通用控制器
   - [detail.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/detail.go): 详情控制器
   - [edit.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/edit.go): 编辑控制器
   - [new.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/new.go): 新建控制器
   - [menu.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/menu.go): 菜单控制器
   - [system.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/system.go): 系统控制器
   - [plugins.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/controller/plugins.go): 插件控制器

2. **Models (数据模型)**:
   - 用户模型
   - 角色模型
   - 权限模型
   - 菜单模型
   - 操作日志模型

3. **Guard (权限守卫)**:
   - [edit.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/modules/guard/edit.go): 编辑权限守卫
   - [new.go](file:///home/pps/code/GoAdmin/GoAdmin/plugins/admin/modules/guard/new.go): 新建权限守卫
   - 删除权限守卫
   - 查询权限守卫

4. **Table (表格生成器)**:
   - 表格配置
   - 列定义
   - 过滤器
   - 操作按钮

**主要功能**:

- 用户管理
- 角色管理
- 权限管理
- 菜单管理
- 操作日志
- 系统设置
- 插件管理
- 代码生成

**使用示例**:

```go
import "github.com/purpose168/GoAdmin/plugins/admin"

// 创建 Admin 插件
adminPlugin := admin.NewAdmin()

// 添加表格生成器
adminPlugin.AddGenerator("users", GetUserTable)

// 添加到引擎
eng.AddPlugins(adminPlugin)
```

---

## 4. 适配器系统

### 4.1 适配器列表

| 适配器 | 目录 | 支持的框架 |
|-------|------|-----------|
| Gin | [adapter/gin/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/gin) | gin-gonic/gin |
| Echo | [adapter/echo/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/echo) | labstack/echo/v4 |
| Chi | [adapter/chi/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/chi) | go-chi/chi |
| Iris | [adapter/iris/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/iris) | kataras/iris/v12 |
| Beego | [adapter/beego/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/beego) | beego/beego/v2 |
| Fiber | [adapter/fiber/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/fiber) | gofiber/fiber/v2 |
| Buffalo | [adapter/buffalo/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/buffalo) | gobuffalo/buffalo |
| Gear | [adapter/gear/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/gear) | teambition/gear |
| GoFrame | [adapter/gf/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/gf) | gogf/gf |
| NetHTTP | [adapter/nethttp/](file:///home/pps/code/GoAdmin/GoAdmin/adapter/nethttp) | net/http |

### 4.2 适配器接口

```go
type Adapter interface {
    Use(app interface{}, routers []Router) error
    Content(ctx interface{}) *Context
}
```

### 4.3 使用示例

```go
import (
    "github.com/gin-gonic/gin"
    "github.com/purpose168/GoAdmin"
    "github.com/purpose168/GoAdmin/adapter/gin"
)

func main() {
    r := gin.Default()

    eng := engine.Default()
    eng.AddConfig(&config.Config{...})
    eng.AddPlugins(admin.NewAdmin())

    ginAdapter := gin.New()
    ginAdapter.Use(r)
    eng.Use(ginAdapter)

    r.Run(":8080")
}
```

---

## 5. 模块间协作

### 5.1 请求处理流程

```
用户请求
    ↓
适配器层 (Adapter)
    ↓
认证中间件 (Auth Middleware)
    ↓
核心引擎 (Engine)
    ↓
插件路由 (Plugin Router)
    ↓
控制器 (Controller)
    ↓
权限守卫 (Guard)
    ↓
数据访问层 (DB Module)
    ↓
数据库 (Database)
    ↓
响应处理
    ↓
模板渲染 (Template + UI Module)
    ↓
返回响应
```

### 5.2 模块依赖关系

```
Engine
    ├── Auth
    │   ├── DB
    │   └── Config
    ├── DB
    │   └── Config
    ├── Menu
    │   ├── DB
    │   └── Auth
    ├── UI
    │   ├── Menu
    │   └── Auth
    ├── File
    │   └── Config
    ├── Logger
    │   └── Config
    ├── Language
    │   └── Config
    ├── System
    │   └── Logger
    ├── Trace
    │   └── Logger
    ├── Errors
    │   └── Logger
    ├── Page
    │   ├── Auth
    │   └── Menu
    ├── Service
    │   └── Config
    ├── Utils
    ├── Collection
    └── Remote Server
        └── Logger
```

---

## 6. 模块扩展

### 6.1 自定义模块

开发者可以创建自定义模块来扩展 GoAdmin 的功能。

**步骤**:

1. 创建模块目录
2. 实现模块功能
3. 注册模块服务
4. 在插件中使用模块

**示例**:

```go
package mymodule

import "github.com/purpose168/GoAdmin/modules/service"

type MyModule struct {
    config *config.Config
}

func New(cfg *config.Config) *MyModule {
    return &MyModule{config: cfg}
}

func (m *MyModule) DoSomething() {
    // 实现功能
}

// 注册服务
service.Register("mymodule", New(cfg))

// 使用服务
myModule := service.Get("mymodule").(*MyModule)
myModule.DoSomething()
```

### 6.2 自定义插件

开发者可以创建自定义插件来扩展 GoAdmin 的功能。

**步骤**:

1. 实现 Plugin 接口
2. 注册路由
3. 实现业务逻辑
4. 添加到引擎

**示例**:

```go
package myplugin

import "github.com/purpose168/GoAdmin/plugins"

type MyPlugin struct {
    *plugins.Base
}

func (p *MyPlugin) InitPlugin(services service.List) {
    p.InitBase(services, "myplugin")
    p.initRouter()
}

func (p *MyPlugin) GetInfo() plugins.Info {
    return plugins.Info{
        Title:       "My Plugin",
        Description: "My custom plugin",
        Author:      "me",
        Version:     "1.0.0",
    }
}

func (p *MyPlugin) IsInstalled() bool {
    return true
}

func New() *MyPlugin {
    return &MyPlugin{
        Base: &plugins.Base{PlugName: "myplugin"},
    }
}
```

---

## 7. 总结

GoAdmin 采用模块化设计，将系统功能划分为多个独立的模块。每个模块负责特定的功能领域，模块之间通过接口进行通信，实现高内聚、低耦合。

### 7.1 模块特点

1. **高内聚**: 每个模块专注于单一功能
2. **低耦合**: 模块之间通过接口通信
3. **易扩展**: 可以轻松添加新模块
4. **易维护**: 每个模块可以独立维护
5. **可复用**: 模块可以在不同项目中复用

### 7.2 模块优势

1. **清晰的结构**: 模块化设计使代码结构清晰
2. **便于测试**: 每个模块可以独立测试
3. **便于扩展**: 可以轻松添加新功能
4. **便于维护**: 每个模块可以独立维护
5. **便于理解**: 模块化设计使代码更易理解

通过合理使用这些模块，开发者可以快速构建功能完善的后台管理系统。
